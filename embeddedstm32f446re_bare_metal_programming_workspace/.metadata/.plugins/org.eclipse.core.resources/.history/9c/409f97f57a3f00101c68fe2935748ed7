#include "adxl.h"

#define MULTI_BYTE_EN 0x40
#define READ_OPERATION 0x80

void adxl_read(uint8_t address,uint8_t *rx_data)
{

	address |= READ_OPERATION;
	address |= MULTI_BYTE_EN;

	cs_enable();

	SPI1_transmit(&address,1);

	SPI1_recieve(rxdata,6);

	cs_disable();


}

void adxl_write (uint8_t address, char value)
{
	uint8_t data[2];
	data[0] = address|MULTI_BYTE_EN;
	data[1] = value;

	cs_enable();

	SPI1_transmit(data,2);

	cs_disable();
}


void adxl_init (void)
{
	SPI1_gpio_init();
	SPI1_config();

	/*Set data format range to +-4g*/
	adxl_write (DATA_FORMAT_R, FOUR_G);

	/*Reset all bits*/
	adxl_write (POWER_CTL_R, RESET);

	/*Configure power control measure bit*/
	adxl_write (POWER_CTL_R, SET_MEASURE_B);
}
